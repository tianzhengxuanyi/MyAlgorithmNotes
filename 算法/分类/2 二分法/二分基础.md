## 二分法

### [基础模型](https://www.bilibili.com/video/BV1AP41137w7/?vd_source=3689e9fbf6b9550d17c35548137fccbb)

**循环不变量(左闭右闭)**

- left: left 表示 left 左侧的数都小于 target
- right: right 表示 right 右侧的数都大于等于 target

```js
function lowerBound(nums, target) {
  let left = 0,
    right = nums.length - 1; // 左闭右闭 [left, right]
  while (left <= right) { // 区间不为空
    let mid = ((right - left) >> 1) + left; // 防止溢出
    if (nums[mid] < target) {
      left = mid + 1; // left表示left左侧的数都小于target，此时mid位置小于target，所以left要等于mid+1；
    } else {
      right = mid - 1; // right表示right右侧的数都大于等于target，此时mid位置大于等于target，所以right要等于mid-1；
    }
  }
  return left; // 最终循环结束，right left指针位置错开，根据循环不变量应返回right + 1 / left (此时left == right + 1)
}
```

### 区间开闭

left和right区间内的元素为待查元素，与target的关系不明确。而区间外的元素与target的关系是明确的，所以二分的[**关键不在于区间里的元素具有什么性质，而是区间外面的元素具有什么性质**](https://blog.csdn.net/groovy2007/article/details/78309120)，也就是循环不变量。

#### 左闭右开区间

**循环不变量(左闭右开)**

- left: left 表示 left 左侧的数都小于 target
- right：right 表示 right 及 right 右侧的数都大于等于 target **☆**

```js
function lowerBound2(nums, target) {
  let left = 0,
    right = nums.length; // 左闭右开 [left, right)
  while (left < right) {
    let mid = ((right - left) >> 1) + left; // 防止溢出
    if (nums[mid] < target) { // 区间不为空
      left = mid + 1; // left表示left左侧的数都小于target，此时mid位置小于target，所以left要等于mid+1；
    } else {
      right = mid; // ☆ right表示right及right右侧的数都大于等于target，此时mid位置大于等于target，所以right要等于mid；
    }
  }
  return left; // 循环结束，left和right指针指向同一个位置，根据循环不变量此时返回right / left(此时left==right)
}
```

#### 左开右开区间

**循环不变量**

- left: left 表示 left 及 left 左侧的数都小于 target
- right：right 表示 right 及 right 右侧的数都大于等于 target

```js
function lowerBound(nums, traget) {
  let left = -1,
    right = nums.length; // 左开右开 (left, right)
  while (left + 1 < right) { // 区间不为空
    let mid = ((right - left) >> 1) + left; // 防止溢出
    if (nums[mid] < target) {
      left = mid; // left表示left及left左侧的数都小于target，此时mid位置小于target，所以left要等于mid；
    } else {
      right = mid; // ☆ right表示right及right右侧的数都大于等于target，此时mid位置大于等于target，所以right要等于mid；
    }
  }
  return right // ☆ 循环结束 (left, right), left指针在right的左侧，根据循环不变量应该返回right；
}
```

### >=、>、<=、<的关系

- `>= target`  lowerBound(target)
- `> target`   upperBound(target) == lowerBound(target + 1)
- `<= target`  upperBound(target) - 1 == lowerBound(target + 1) - 1
- `< target`   lowerBound(target) - 1 
