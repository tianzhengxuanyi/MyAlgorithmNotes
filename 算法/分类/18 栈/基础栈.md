## åŸºç¡€

## ä¸´é¡¹æ¶ˆé™¤

## åˆæ³•æ‹¬å·å­—ç¬¦ä¸²

æ³¨ï¼šéƒ¨åˆ†é¢˜ç›®å¯ä»¥ä¸ç”¨æ ˆï¼Œè€Œæ˜¯ç”¨ä¸€ä¸ªæ•°å­—è®°å½•åµŒå¥—æ·±åº¦ã€‚

### [921. ä½¿æ‹¬å·æœ‰æ•ˆçš„æœ€å°‘æ·»åŠ ](https://leetcode.cn/problems/minimum-add-to-make-parentheses-valid/description/)

åªæœ‰æ»¡è¶³ä¸‹é¢å‡ ç‚¹ä¹‹ä¸€ï¼Œæ‹¬å·å­—ç¬¦ä¸²æ‰æ˜¯æœ‰æ•ˆçš„ï¼š

- å®ƒæ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…
- å®ƒå¯ä»¥è¢«å†™æˆ AB ï¼ˆA ä¸ B è¿æ¥ï¼‰, å…¶ä¸­ A å’Œ B éƒ½æ˜¯æœ‰æ•ˆå­—ç¬¦ä¸²ï¼Œæˆ–è€…
- å®ƒå¯ä»¥è¢«å†™ä½œ (A)ï¼Œå…¶ä¸­ A æ˜¯æœ‰æ•ˆå­—ç¬¦ä¸²ã€‚
  ç»™å®šä¸€ä¸ªæ‹¬å·å­—ç¬¦ä¸² s ï¼Œåœ¨æ¯ä¸€æ¬¡æ“ä½œä¸­ï¼Œä½ éƒ½å¯ä»¥åœ¨å­—ç¬¦ä¸²çš„ä»»ä½•ä½ç½®æ’å…¥ä¸€ä¸ªæ‹¬å·

ä¾‹å¦‚ï¼Œå¦‚æœ s = "()))" ï¼Œä½ å¯ä»¥æ’å…¥ä¸€ä¸ªå¼€å§‹æ‹¬å·ä¸º "(()))" æˆ–ç»“æŸæ‹¬å·ä¸º "())))" ã€‚
è¿”å› ä¸ºä½¿ç»“æœå­—ç¬¦ä¸² s æœ‰æ•ˆè€Œå¿…é¡»æ·»åŠ çš„æœ€å°‘æ‹¬å·æ•°ã€‚

> æ ˆé¡¶ä¸è¿›æ ˆæ‹¬å·é…å¯¹æ—¶æ¶ˆé™¤ï¼Œå½“æœ€åæ ˆä¸­å‰©ä¸‹çš„å…ƒç´ ä¸ªæ•°ä¸ºç­”æ¡ˆ

```js
/**
 * @param {string} s
 * @return {number}
 */
var minAddToMakeValid = function (s) {
  const st = [];
  for (let q of s) {
    if (st.length === 0 || !(st[st.length - 1] === "(" && q === ")")) {
      st.push(q);
    } else {
      st.pop();
    }
  }
  return st.length;
};
```

> ç”¨ score è®°å½•å¾—åˆ†ï¼Œ"("è¿›æ ˆå¾—åˆ†åŠ ä¸€ï¼Œ")"è¿›æ ˆå¾—åˆ†å‡ä¸€ã€‚å½“æŸä¸ª")"å…¥æ ˆä½¿å¾— score å°äº 0 æ—¶ï¼Œè¡¨ç¤ºå·¦ä¾§çš„"("æ•°é‡ä¸æ»¡è¶³é…å¯¹ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªï¼Œå› æ­¤ ans åŠ ä¸€ï¼Œå¹¶å°† score åŠ ä¸€ã€‚
> æœ€ç»ˆç»“æœä¸ºéå†åçš„ scoreï¼ˆå­—ç¬¦ä¸­å‰©ä½™æœªé…å¯¹çš„"("æ•°é‡ï¼‰åŠ ä¸Š ansã€‚

```js
/**
 * @param {string} s
 * @return {number}
 */
var minAddToMakeValid = function (s) {
  let ans = 0,
    score = 0;
  for (let q of s) {
    score += q === "(" ? 1 : -1;
    if (score < 0) {
      ans++;
      score = 0;
    }
  }
  return ans + score;
};
```

### [1963. ä½¿å­—ç¬¦ä¸²å¹³è¡¡çš„æœ€å°äº¤æ¢æ¬¡æ•°](https://leetcode.cn/problems/minimum-number-of-swaps-to-make-the-string-balanced/description/)

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œä¸‹æ ‡ä» 0 å¼€å§‹ ï¼Œä¸”é•¿åº¦ä¸ºå¶æ•° n ã€‚å­—ç¬¦ä¸² æ°å¥½ ç”± n / 2 ä¸ªå¼€æ‹¬å· '[' å’Œ n / 2 ä¸ªé—­æ‹¬å· ']' ç»„æˆã€‚

åªæœ‰èƒ½æ»¡è¶³ä¸‹è¿°æ‰€æœ‰æ¡ä»¶çš„å­—ç¬¦ä¸²æ‰èƒ½ç§°ä¸º å¹³è¡¡å­—ç¬¦ä¸² ï¼š

- å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…
- å­—ç¬¦ä¸²å¯ä»¥è®°ä½œ AB ï¼Œå…¶ä¸­ A å’Œ B éƒ½æ˜¯ å¹³è¡¡å­—ç¬¦ä¸² ï¼Œæˆ–è€…
- å­—ç¬¦ä¸²å¯ä»¥å†™æˆ [C] ï¼Œå…¶ä¸­ C æ˜¯ä¸€ä¸ª å¹³è¡¡å­—ç¬¦ä¸² ã€‚
- ä½ å¯ä»¥äº¤æ¢ ä»»æ„ ä¸¤ä¸ªä¸‹æ ‡æ‰€å¯¹åº”çš„æ‹¬å· ä»»æ„ æ¬¡æ•°ã€‚

è¿”å›ä½¿ s å˜æˆ å¹³è¡¡å­—ç¬¦ä¸² æ‰€éœ€è¦çš„ æœ€å° äº¤æ¢æ¬¡æ•°ã€‚

[é¢˜è§£](https://leetcode.cn/problems/minimum-number-of-swaps-to-make-the-string-balanced/solutions/922728/go-tan-xin-by-endlesscheng-7h9n/)

> è´ªå¿ƒ
>
> å¯¹äºä¸€ä¸ªå¹³è¡¡å­—ç¬¦ä¸²ï¼Œä»å·¦å¾€å³éå†å®ƒï¼Œç»Ÿè®¡æœªåŒ¹é…çš„å·¦æ‹¬å·çš„ä¸ªæ•° cï¼Œé‡åˆ°å·¦æ‹¬å·å°±åŠ ä¸€ï¼Œé‡åˆ°å³æ‹¬å·å°±å‡ä¸€ï¼Œå¦‚æœä»»ä½•æ—¶åˆ» c éƒ½ä¸ä¸ºè´Ÿæ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯å¹³è¡¡çš„ã€‚

> å¦‚æœéå†æ—¶é‡åˆ°å³æ‹¬å·å¹¶ä¸”æ­¤æ—¶ c=0ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨åé¢æ‰¾ä¸€ä¸ªå·¦æ‹¬å·å¹¶ä¸è¿™ä¸ªå³æ‹¬å·äº¤æ¢ã€‚

> ä¸ºäº†ä½¿åç»­çš„äº¤æ¢æ¬¡æ•°æœ€å°ï¼Œè¿™ä¸ªè¢«äº¤æ¢èµ°çš„å³æ‹¬å·åº”å½“è¶Šé å³è¶Šå¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‹¿å­—ç¬¦ä¸²æœ€å³è¾¹çš„å·¦æ‹¬å·æ¥äº¤æ¢ã€‚

> å®é™…ä»£ç ä¸­ï¼Œå¯ä»¥ä¸ç”¨ç¼–å†™ã€Œäº¤æ¢ã€çš„é€»è¾‘ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ€»æ˜¯é€‰æ‹©æœ€å³è¾¹çš„å·¦æ‹¬å·ï¼Œå› æ­¤åœ¨åç»­çš„éå†ä¸­ï¼Œè‹¥é‡åˆ°äº†è¿™äº›å·¦æ‹¬å·ï¼Œåœ¨äº¤æ¢åçš„å­—ç¬¦ä¸²ä¸Šï¼Œè¯¥ä½ç½®åŠåé¢å¿…ç„¶å…¨éƒ¨æ˜¯å³æ‹¬å·ï¼Œå³æ­¤æ—¶è¯¥å­—ç¬¦ä¸²å·²ç»æ˜¯å¹³è¡¡çš„äº†ã€‚

> å› æ­¤ï¼Œå½“é‡åˆ°å³æ‹¬å·å¹¶ä¸”æ­¤æ—¶ c=0ï¼Œå¯ä»¥ç›´æ¥å°† c å’Œç­”æ¡ˆåŠ ä¸€ï¼Œå³è§†ä½œå°†ä¸€ä¸ªå·¦æ‹¬å·å’Œè¯¥å³æ‹¬å·äº¤æ¢ã€‚ç”±äºæ²¡æœ‰å®é™…äº¤æ¢æ‹¬å·ï¼Œè‹¥åé¢åˆé‡æ–°é‡åˆ°äº†éœ€è¦è¢«äº¤æ¢çš„å·¦æ‹¬å·ï¼Œç”±äºæ­¤æ—¶å­—ç¬¦ä¸²å·²ç»æ˜¯å¹³è¡¡çš„äº†ï¼Œæ•…ä¸ä¼šå¯¹ç­”æ¡ˆäº§ç”Ÿå½±å“ã€‚

[é¢˜è§£ 2](https://leetcode.cn/problems/minimum-number-of-swaps-to-make-the-string-balanced/solutions/1103157/ke-fang-xin-shi-yong-de-tan-xin-mo-ni-by-l02a/)

> é¢˜ç›®åˆ†æï¼šç¬¬ä¸€çœ¼çœ‹è¿™é“é¢˜ï¼Œå¯èƒ½ä¼šæŠŠè¿™é“é¢˜å’Œå…¶ä»–ç±»å‹çš„æ‹¬å·åŒ¹é…é¢˜è”æƒ³èµ·æ¥ï¼Œä»è€Œä½¿å¾—éš¾åº¦ä¸Šå‡ã€‚ä½†æ˜¯ä»”ç»†å®¡é¢˜åï¼Œä¾¿ä¼šæœ‰æ‰€æ€è·¯ã€‚

> - æˆ‘ä»¬éœ€è¦å…ˆå…·å¤‡ä¸€ä¸ªæ€æƒ³: å¯¹äºä¸¤ä¸ªå¹³è¡¡å­—ç¬¦ä¸² sâ€²å’Œ tï¼Œå°† t æ’å…¥ sâ€²çš„ä»»æ„ä½ç½®éƒ½ä¸ä¼šæ”¹å˜ sâ€²çš„å¹³è¡¡å±æ€§ã€‚
> - å…·å¤‡ä¸Šè¿°æ€æƒ³åï¼Œå¯ä»¥å¿½ç•¥ä¸€ä¸ªéå¹³è¡¡ä¸² s ä¸­æ‰€æœ‰å·²åŒ¹é…çš„æ‹¬å·ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ä¸²åªèƒ½æ˜¯ " ] ] ] ... [ [ [ " è¿™ç§å½¢å¼
> - åŒæ—¶å¯¹äºä¸€ä¸ªéå¹³è¡¡å­—ç¬¦ä¸² s è€Œè¨€ï¼Œè‹¥ 0 < s.size() â‰¤ 2ï¼Œé‚£ä¹ˆåªéœ€è¦è¿›è¡Œä¸€æ¬¡äº¤æ¢ï¼Œè‹¥ s.size() > 2ï¼Œåˆ™æ¯æ¬¡äº¤æ¢æœ€å¤šèƒ½å½¢æˆä¸¤ç»„åŒ¹é… (æ¯æ¬¡äº¤æ¢ä¸¤ä¸ªã€Œå„è‡ªæ‰€åœ¨çš„æ‹¬å·é˜Ÿä¼ä¸­ã€éè¾¹ç¼˜çš„æ‹¬å·ï¼Œæ¯æ¬¡å¯ä»¥å°†ã€Œä¸åŒ¹é…ç»„æ•°ã€- 2)

> æ–‡å­—æè¿°å¯èƒ½ä¼šå¾ˆç»•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸ªä¾‹å­æ„Ÿå—ä¸€ä¸‹ï¼šå¯¹äº s = " ] ] ] [ [ [ "ï¼Œè‹¥éœ€è¦å°† s å˜ä¸ºå¹³è¡¡å­—ç¬¦ä¸²ï¼Œå¯ä»¥å…ˆå°†åŠ ç²—çš„æ‹¬å·è¿›è¡Œäº¤æ¢ï¼š s = "] ] ] [ [ [ " ï¼Œå¾—åˆ° s = " ] [ ] [ [ ] " ï¼ŒåŒæ—¶å¿½ç•¥å·²åŒ¹é…çš„ï¼Œåˆ™åªå‰©ä¸‹ " ] [ " ï¼Œå†è¿›è¡Œä¸€æ¬¡äº¤æ¢å³å¯ã€‚

```js
/**
 * @param {string} s
 * @return {number}
 */
var minSwaps = function (s) {
  let score = 0,
    res = 0; // scoreä¸º"["ä¸ªæ•°
  for (let i of s) {
    score += i === "[" ? 1 : -1;
    if (i === "]" && score < 0) {
      res += 1; // äº¤æ¢æ¬¡æ•°åŠ ä¸€
      score = 1; // æ‹¬å·äº¤æ¢åï¼Œscoreå˜ä¸º1
    }
  }
  return res;
};
```

### [â­2116. åˆ¤æ–­ä¸€ä¸ªæ‹¬å·å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆ](https://leetcode.cn/problems/check-if-a-parentheses-string-can-be-valid/description/?envType=daily-question&envId=2025-03-23)

ä¸€ä¸ªæ‹¬å·å­—ç¬¦ä¸²æ˜¯åªç”± '(' å’Œ ')' ç»„æˆçš„ éç©º å­—ç¬¦ä¸²ã€‚å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²æ»¡è¶³ä¸‹é¢ ä»»æ„ ä¸€ä¸ªæ¡ä»¶ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯æœ‰æ•ˆçš„ï¼š

å­—ç¬¦ä¸²ä¸º ().
å®ƒå¯ä»¥è¡¨ç¤ºä¸º ABï¼ˆA ä¸ B è¿æ¥ï¼‰ï¼Œå…¶ä¸­A å’Œ B éƒ½æ˜¯æœ‰æ•ˆæ‹¬å·å­—ç¬¦ä¸²ã€‚
å®ƒå¯ä»¥è¡¨ç¤ºä¸º (A) ï¼Œå…¶ä¸­ A æ˜¯ä¸€ä¸ªæœ‰æ•ˆæ‹¬å·å­—ç¬¦ä¸²ã€‚
ç»™ä½ ä¸€ä¸ªæ‹¬å·å­—ç¬¦ä¸² s å’Œä¸€ä¸ªå­—ç¬¦ä¸² locked ï¼Œä¸¤è€…é•¿åº¦éƒ½ä¸º n ã€‚locked æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ŒåªåŒ…å« '0' å’Œ '1' ã€‚å¯¹äº locked ä¸­ æ¯ä¸€ä¸ª ä¸‹æ ‡ i ï¼š

å¦‚æœ locked[i] æ˜¯ '1' ï¼Œä½  ä¸èƒ½ æ”¹å˜ s[i] ã€‚
å¦‚æœ locked[i] æ˜¯ '0' ï¼Œä½  å¯ä»¥ å°† s[i] å˜ä¸º '(' æˆ–è€… ')' ã€‚
å¦‚æœä½ å¯ä»¥å°† s å˜ä¸ºæœ‰æ•ˆæ‹¬å·å­—ç¬¦ä¸²ï¼Œè¯·ä½ è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚

[**é¢˜è§£**](https://leetcode.cn/problems/check-if-a-parentheses-string-can-be-valid/solutions/1178043/zheng-fan-liang-ci-bian-li-by-endlessche-z8ac/?envType=daily-question&envId=2025-03-23)
> è®°å½•å·¦æ‹¬å·çš„æ•°é‡ï¼Œå­˜åœ¨å¯é€‰å­—ç¬¦æ—¶ï¼Œå¯é€‰å­—ç¬¦æ—¢å¯ä»¥æ˜¯å·¦æ‹¬å·ä¹Ÿå¯ä»¥æ˜¯å³æ‹¬å·ï¼Œæ‰€ä»¥éœ€è¦ç»´æŠ¤å·¦æ‹¬å·æ•°é‡çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚

```js
/**
 * @param {string} s
 * @param {string} locked
 * @return {boolean}
 */
var canBeValid = function (s, locked) {
    if (s.length % 2) return false;
    let mn = mx = 0;;
    for (let i = 0; i < s.length; i++) {
        if (locked[i] == 0) {
            mn = mn - 1;
            mx = mx + 1;
        } else {
            let current = s[i] === "(" ? 1 : -1;
            mn += current;
            mx += current;
        }
        if (mx < 0) return false;
        if (mn < 0) mn = 1;
    }
    return mn === 0;
};
```

## è¡¨è¾¾å¼è§£æ

### [è¡¨è¾¾å¼è§£æé—®é¢˜-åŒæ ˆæ¨¡ç‰ˆ](https://leetcode.cn/problems/basic-calculator-ii/solutions/648832/shi-yong-shuang-zhan-jie-jue-jiu-ji-biao-c65k/)

å¯¹äºã€Œä»»ä½•è¡¨è¾¾å¼ã€è€Œè¨€ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨ä¸¤ä¸ªæ ˆ nums å’Œ opsï¼š

- nums ï¼š å­˜æ”¾æ‰€æœ‰çš„æ•°å­—
- ops ï¼šå­˜æ”¾æ‰€æœ‰çš„æ•°å­—ä»¥å¤–çš„æ“ä½œ

ç„¶åä»å‰å¾€ååšï¼Œå¯¹éå†åˆ°çš„å­—ç¬¦åšåˆ†æƒ…å†µè®¨è®ºï¼š

- ç©ºæ ¼ : è·³è¿‡
- `(` : ç›´æ¥åŠ å…¥ ops ä¸­ï¼Œç­‰å¾…ä¸ä¹‹åŒ¹é…çš„ `)`
- `)` : ä½¿ç”¨ç°æœ‰çš„ nums å’Œ ops è¿›è¡Œè®¡ç®—ï¼Œç›´åˆ°é‡åˆ°å·¦è¾¹æœ€è¿‘çš„ä¸€ä¸ªå·¦æ‹¬å·ä¸ºæ­¢ï¼Œè®¡ç®—ç»“æœæ”¾åˆ° nums
- æ•°å­— : ä»å½“å‰ä½ç½®å¼€å§‹ç»§ç»­å¾€åå–ï¼Œå°†æ•´ä¸€ä¸ªè¿ç»­æ•°å­—æ•´ä½“å–å‡ºï¼ŒåŠ å…¥ nums
- `+ - * / ^ %` : éœ€è¦å°†æ“ä½œæ”¾å…¥ ops ä¸­ã€‚åœ¨æ”¾å…¥ä¹‹å‰å…ˆæŠŠæ ˆå†…å¯ä»¥ç®—çš„éƒ½ç®—æ‰ï¼ˆåªæœ‰ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®—ï¼‰ï¼Œä½¿ç”¨ç°æœ‰çš„ nums å’Œ ops è¿›è¡Œè®¡ç®—ï¼Œç›´åˆ°æ²¡æœ‰æ“ä½œæˆ–è€…é‡åˆ°å·¦æ‹¬å·ï¼Œè®¡ç®—ç»“æœæ”¾åˆ° nums
  æˆ‘ä»¬å¯ä»¥é€šè¿‡ ğŸŒ° æ¥ç†è§£ åªæœ‰ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®— æ˜¯ä»€ä¹ˆæ„æ€ï¼š

å› ä¸ºæˆ‘ä»¬æ˜¯ä»å‰å¾€ååšçš„ï¼Œå‡è®¾æˆ‘ä»¬å½“å‰å·²ç»æ‰«æåˆ° 2 + 1 äº†ï¼ˆæ­¤æ—¶æ ˆå†…çš„æ“ä½œä¸º + ï¼‰ã€‚

1. å¦‚æœåé¢å‡ºç°çš„ + 2 æˆ–è€… - 1 çš„è¯ï¼Œæ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œå¯ä»¥å°† 2 + 1 ç®—æ‰ï¼ŒæŠŠç»“æœæ”¾åˆ° nums ä¸­ï¼›
2. å¦‚æœåé¢å‡ºç°çš„æ˜¯ \* 2 æˆ–è€… / 1 çš„è¯ï¼Œä¸æ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œè¿™æ—¶å€™ä¸èƒ½è®¡ç®— 2 + 1ã€‚

ä¸€äº›ç»†èŠ‚ï¼š

- ç”±äºç¬¬ä¸€ä¸ªæ•°å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œä¸ºäº†å‡å°‘è¾¹ç•Œåˆ¤æ–­ã€‚ä¸€ä¸ªå°æŠ€å·§æ˜¯å…ˆå¾€ nums æ·»åŠ ä¸€ä¸ª 0
- ä¸ºé˜²æ­¢ () å†…å‡ºç°çš„é¦–ä¸ªå­—ç¬¦ä¸ºè¿ç®—ç¬¦ï¼Œå°†æ‰€æœ‰çš„ç©ºæ ¼å»æ‰ï¼Œå¹¶å°† (- æ›¿æ¢ä¸º (0-ï¼Œ(+ æ›¿æ¢ä¸º (0+ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸è¿›è¡Œè¿™æ ·çš„é¢„å¤„ç†ï¼Œå°†è¿™ä¸ªå¤„ç†é€»è¾‘æ”¾åˆ°å¾ªç¯é‡Œå»åšï¼‰
- ä»ç†è®ºä¸Šåˆ†æï¼Œnums æœ€å¥½å­˜æ”¾çš„æ˜¯ longï¼Œè€Œä¸æ˜¯ intã€‚å› ä¸ºå¯èƒ½å­˜åœ¨ å¤§æ•° + å¤§æ•° + å¤§æ•° + â€¦ - å¤§æ•° - å¤§æ•° çš„è¡¨è¾¾å¼å¯¼è‡´ä¸­é—´ç»“æœæº¢å‡ºï¼Œæœ€ç»ˆç­”æ¡ˆä¸æº¢å‡ºçš„æƒ…å†µ


### [224. åŸºæœ¬è®¡ç®—å™¨](https://leetcode.cn/problems/basic-calculator/description/)

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ s ï¼Œè¯·ä½ å®ç°ä¸€ä¸ªåŸºæœ¬è®¡ç®—å™¨æ¥è®¡ç®—å¹¶è¿”å›å®ƒçš„å€¼ã€‚

æ³¨æ„:ä¸å…è®¸ä½¿ç”¨ä»»ä½•å°†å­—ç¬¦ä¸²ä½œä¸ºæ•°å­¦è¡¨è¾¾å¼è®¡ç®—çš„å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚ eval() ã€‚

- 1 <= s.length <= 3 * 105
- s ç”±æ•°å­—ã€'+'ã€'-'ã€'('ã€')'ã€å’Œ ' ' ç»„æˆ
- s è¡¨ç¤ºä¸€ä¸ªæœ‰æ•ˆçš„è¡¨è¾¾å¼
- '+' ä¸èƒ½ç”¨ä½œä¸€å…ƒè¿ç®—(ä¾‹å¦‚ï¼Œ "+1" å’Œ "+(2 + 3)" æ— æ•ˆ)
- '-' å¯ä»¥ç”¨ä½œä¸€å…ƒè¿ç®—(å³ "-1" å’Œ "-(2 + 3)" æ˜¯æœ‰æ•ˆçš„)
- è¾“å…¥ä¸­ä¸å­˜åœ¨ä¸¤ä¸ªè¿ç»­çš„æ“ä½œç¬¦
- æ¯ä¸ªæ•°å­—å’Œè¿è¡Œçš„è®¡ç®—å°†é€‚åˆäºä¸€ä¸ªæœ‰ç¬¦å·çš„ 32ä½ æ•´æ•°

```js
/**
 * @param {string} s
 * @return {number}
 */
var calculate = function (s) {
  s = s.replaceAll(" ", "");
  const nums = [],
    ops = [],
    len = s.length;
  if (s[0] === "-") {
    nums.push(0);
  }
  let i = 0;
  while (i < len) {
    if (s[i] === "(") {
      ops.push(s[i++]);
    } else if (s[i] === ")") {
      while (ops[ops.length - 1] !== "(") {
        calc(nums, ops);
      }
      ops.pop();
      i++;
    } else if (!isNaN(Number(s[i]))) {
      let num = "";
      while (i < len && !isNaN(Number(s[i]))) {
        num += s[i++];
      }
      nums.push(num - 0);
    } else {
      if (i > 0 && (s[i - 1] === "(" || s[i - 1] === "+" || s[i - 1] === "-")) {
        nums.push(0);
      }
      while (ops.length && ops[ops.length - 1] !== "(") {
        calc(nums, ops);
      }
      ops.push(s[i++]);
    }
  }
  while (ops.length) {
    calc(nums, ops);
  }
  return nums[0];
};

const operation = {
  "+": (a, b) => a + b,
  "-": (a, b) => a - b,
};

const calc = (nums, ops) => {
  if (nums.length < 2 || !ops.length) {
    return;
  }
  let op = ops.pop(),
    b = nums.pop(),
    a = nums.pop();
  nums.push(operation[op](a, b));
};
```

### [227. åŸºæœ¬è®¡ç®—å™¨ II](https://leetcode.cn/problems/basic-calculator-ii/description/)

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ s ï¼Œè¯·ä½ å®ç°ä¸€ä¸ªåŸºæœ¬è®¡ç®—å™¨æ¥è®¡ç®—å¹¶è¿”å›å®ƒçš„å€¼ã€‚

æ•´æ•°é™¤æ³•ä»…ä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚

ä½ å¯ä»¥å‡è®¾ç»™å®šçš„è¡¨è¾¾å¼æ€»æ˜¯æœ‰æ•ˆçš„ã€‚æ‰€æœ‰ä¸­é—´ç»“æœå°†åœ¨ [-231, 231 - 1] çš„èŒƒå›´å†…ã€‚

æ³¨æ„ï¼šä¸å…è®¸ä½¿ç”¨ä»»ä½•å°†å­—ç¬¦ä¸²ä½œä¸ºæ•°å­¦è¡¨è¾¾å¼è®¡ç®—çš„å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚ eval() ã€‚

```js
/**
 * @param {string} s
 * @return {number}
 */
var calculate = function (s) {
  const nums = [],
    ops = [],
    len = s.length;
  let i = 0;
  while (i < len) {
    if (s[i] === " ") {
      i++;
    } else if (!isNaN(Number(s[i]))) {
      let num = "";
      while (i < len && !isNaN(Number(s[i]))) {
        num += s[i++];
      }
      nums.push(num - 0);
    } else {
      while (ops.length && map[s[i]] <= map[ops[ops.length - 1]]) {
        calc(nums, ops);
      }
      ops.push(s[i++]);
    }
  }
  while (ops.length) {
    calc(nums, ops);
  }
  return nums[0];
};

const map = {
  "+": 1,
  "-": 1,
  "*": 2,
  "/": 2,
};
const operation = {
  "+": (a, b) => a + b,
  "-": (a, b) => a - b,
  "*": (a, b) => a * b,
  "/": (a, b) => {
    let r = a / b;
    return r >= 0 ? Math.floor(r) : Math.ceil(r);
  },
};
const calc = (nums, ops) => {
  if (nums.length < 2 || !ops.length) return;
  let op = ops.pop(),
    b = nums.pop(),
    a = nums.pop();
  nums.push(operation[op](a, b));
};
```


